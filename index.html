<!doctype html public "display of affection">
<title>ic-droppable demo</title>
<link rel="stylesheet" href="http://instructure.github.io/ic-ember/shared/styles.css">
<link rel="stylesheet" href="main.css">

<header class="branding padbox">
  <h1>ic.Droppable</h1>
  <h2>Ember View/Component Mixin for native drag and drop targets.</h2>
  <p>By <a target="_top" href="http://instructure.com">Instructure, Inc</a></p>
  <p><a href="https://github.com/instructure/ic-droppable/tree/gh-pages">Demo Source</a></p>
</header>

<div id="demo" class="padbox"></div>

<a target="_top" href="https://github.com/instructure/ic-droppable"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://github-camo.global.ssl.fastly.net/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>


<script type="text/x-handlebars">
{{#x-image-drop images=userImages}}
  Drop one or many jpegs on me (and only jpegs)
{{/x-image-drop}}

<br>

{{#each image in userImages}}
  <img {{bind-attr src=image.src title=image.name}}>
{{/each}}
</script>

<script src="bower_components/jquery/dist/jquery.js"></script>
<script src="bower_components/handlebars/handlebars.js"></script>
<script src="bower_components/ember/ember.js"></script>
<script src="bower_components/ic-droppable/dist/globals/main.js"></script>

<script>
var Droppable = ic.Droppable.default;

App = Ember.Application.create({
  rootElement: '#demo'
});

App.XImageDropComponent = Ember.Component.extend(Droppable, {

  tagName: 'x-image-drop',

  setImages: function() {
    this.set('images', []);
  }.on('init'),

  validateDragEvent: function(event) {
    var files = event.dataTransfer.files;
    return [].reduce.call(files, function(accept, file) {
      if (!accept) return false;
      return file.type == 'image/jpeg';
    }, true);
  },

  acceptDrop: function(event) {
    event.preventDefault();
    var files = event.dataTransfer.files;
    var images = this.get('images');
    [].forEach.call(files, function(file) {
      var reader = new FileReader();
      reader.onload = function(e) {
        file.src = e.target.result;
        images.addObject(file);
      };
      reader.readAsDataURL(file);
    });
  }
});
</script>

